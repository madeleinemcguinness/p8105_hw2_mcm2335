---
title: "p8105_hw2_mcm2335"
author: "Madeleine McGuinness"
date: "2023-10-03"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

## Set Up
```{r}
#set working directory
setwd("~/Desktop/R_Building_Blocks_P8105/p8105_hw2_mcm2335")
```

## Question 1 

## Import CSV Data Tables
```{r}
pols_month = read_csv(file = "./data/pols-month.csv")

unemployment = read_csv(file = "./data/unemployment.csv")

snp = read_csv(file = "./data/snp.csv")
```

## Clean Data Table: Pols-month
```{r}
names(pols_month) # names look clean

pols_month_2 <- pols_month |>
  separate(col = mon, into=c('year', 'month', 'day', sep='-')) #sep mon column

pols_month_2 <- pols_month_2 |>
  select(-'-') #remove '-' column

pols_month_2 <- pols_month_2 |>
  mutate(month = if_else(month == "01", "January", if_else(month == "02", "February", if_else(month == "03", "March", if_else(month == "04", "April", if_else(month == "05", "May", if_else(month == "06", "June", if_else(month == "07", "July", if_else(month == "08", "August", if_else(month == "09", "September", if_else(month == "10", "October", if_else(month == "11", "November", "December")))))))))))) #mutate month numbers to month names

pols_month_2 <- pols_month_2 |>
  mutate(president = if_else(prez_dem == 1, "dem", if_else(prez_gop == 1, "gop", NA_character_))) # new president value using prez_dem and prez_gop

pols_month_3 <- pols_month_2 |>
  select(-prez_dem, -prez_gop) # remove prez_dem and prez_gop variables

pols_month_final <- pols_month_3 |>
  select(-day) # remove day variable
```

## Clean Data Table: snp
```{r}
names(snp) # names look clean

snp_2 <- snp |>
  separate(col = date, into=c('month', 'day', 'year', sep='/')) #sep date column

snp_2 <- snp_2 |>
  select(-'/') #remove '/' column

snp_2 <- snp_2 |>
  mutate(month = if_else(month == "1", "January", if_else(month == "2", "February", if_else(month == "3", "March", if_else(month == "4", "April", if_else(month == "5", "May", if_else(month == "6", "June", if_else(month == "7", "July", if_else(month == "8", "August", if_else(month == "9", "September", if_else(month == "10", "October", if_else(month == "11", "November", "December")))))))))))) #mutate month numbers to month names

snp_final <- snp_2 |>
  select(year, month, day, close) # arrange final snp dataset by year, month

snp_final <- snp_final |>
  transform(year = as.numeric(year)) # tranform year to numeric 

snp_final <- snp_final |>
  mutate(year = if_else(year < 16, year + 2000, year + 1900)) |>
  select(-day) |>
  transform(year = as.character(year))# mutate year to 4 digits instead of 2 digits for consistency with pols_month_final dataset and remove day, year back to character value
```

## Clean Data Table: unemployment
```{r}
names(unemployment) #need to clean to make names all lowercase

unemployment_2 <- janitor::clean_names(unemployment) #cleaned names

unemployment_3 <- unemployment_2 |>
  pivot_longer(
    jan:dec, 
    names_to = "month",
    values_to = "unemployment") #pivoted from wide to long format

unemployment_final <- unemployment_3 |>
  mutate(month = if_else(month == "jan", "January", if_else(month == "feb", "February", if_else(month == "mar", "March", if_else(month == "apr", "April", if_else(month == "may", "May", if_else(month == "jun", "June", if_else(month == "jul", "July", if_else(month == "aug", "August", if_else(month == "sep", "September", if_else(month == "oct", "October", if_else(month == "nov", "November", "December")))))))))))) |>
  transform(year = as.character(year))#mutate month abbreviations to month names, transform year to character for consistency
```

## Merge Data Tables
```{r}
combined_data =
  left_join(pols_month_final, snp_final)

combined_data_final =
  left_join(combined_data, unemployment_final)
```

## Answer 
The `pols_month_final` dataset has `r nrow(pols_month_final)` observations and `r ncol(pols_month_final)` variables and indicates the political affiliation of presidents from `r pols |> pull(year) |> min()` to `r pols |> pull(year) |> max()` and the distribution of governers and senators by political affiliation. The `snp_final` dataset has `r nrow(snp_final)` observations and `r ncol(snp_final)` variables and has close information by month and year from `r pols |> pull(year) |> min()` to `r pols |> pull(year) |> max()`. The `unemployment_final` dataset has `r nrow(unemployment_final)` observations and `r ncol(unemployment_final)` variables and provides national unemployment rates by month and year from `r pols |> pull(year) |> min()` to `r pols |> pull(year) |> max()`. The `combined_data_final` dataset merges all of these variables by month and year and has 53 total NAs.

## Question 2 

